---
title: 快速傅里叶变化结果分析
author: lixinghui
date: 2023-7-10 14:10:00 +0800
categories: [DSP, FFT]
tags: [数字信号处理]
math: true
render_with_liquid: false
---





复制从：https://blog.csdn.net/wordwarwordwar/article/details/68951605



---

​		FFT 是离散傅立叶变换的快速算法，可以将一个信号变换到频域。有些信号在时域上是很难看出什么特征的，但是如果变换到频域之后，就很容易看出特征了。这就是很多信号分析采用 FFT 变换的原因。另外，FFT 可以将一个信号的频谱提取出来，这在频谱分析方面也是经常用的。

​		虽然很多人都知道 FFT 是什么，可以用来做什么，怎么去做，但是却不知道 FFT 之后的结果是什意思、如何决定要使用多少点来做 FFT。

​		一个模拟信号，经过 ADC 采样之后，就变成了数字信号。采样定理告诉我们，采样频率要大于信号频率的两倍，这些我就不在此罗嗦了。

​		采样得到的数字信号，就可以做 FFT 变换了。N 个采样点，经过 FFT 之后，就可以得到 N 个点的 FFT 结果。为了方便进行 FFT 运算，通常 N 取 2 的整数次方。

​		**假设采样频率为 Fs，信号频率 F，采样点数为 N。那么 FFT 之后结果就是一个为 N 点的复数。每一个点就对应着一个频率点。这个点的模值，就是该频率值下的幅度特性。具体跟原始信号的幅度有什么关系呢？假设原始信号的峰值为 A，那么 FFT 的结果的每个点（除了第一个点直流分量之外）的模值就是 A 的 N/2 倍。而第一个点就是直流分量，它的模值就是直流分量的 N 倍。而每个点的相位呢，就是在该频率下的信号的相位。第一个点表示直流分量（即 0Hz），而最后一个点 N 的再下一个点（实际上这个点是不存在的，这里是假设的第 N+1 个点，可以看做是将第一个点分做两半分，另一半移到最后）则表示采样频率 Fs，这中间被 N-1 个点平均分成 N 等份，每个点的频率依次增加。例如某点 n 所表示的频率为：。由上面的公式可以看出，Fn 所能分辨到频率为 Fs/N，如果采样频率 Fs 为 1024Hz，采样点数为 1024 点，则可以分辨到 1Hz。1024Hz 的采样率采样 1024 点，刚好是 1 秒，也就是说，采样 1 秒时间的信号并做 FFT，则结果可以分析到 1Hz，如果采样 2 秒时间的信号并做 FFT，则结果可以分析到 0.5Hz。如果要提高频率分辨力，则必须增加采样点数，也即采样时间。频率分辨率和采样时间是倒数关系。假设 FFT 之后某点 n 用复数 a+bi 表示，那么这个复数的模就是，相位就是。根据以上的结果，就可以计算出 n 点（n≠1，且 n<=N/2）对应的信号的表达式为：，即。对于 n=1 点的信号，是直流分量，幅度即为 A1/N。由于 FFT 结果的对称性，通常我们只使用前半部分的结果，即小于采样频率一半的结果。**

​		好了，说了半天，看着公式也晕，下面以一个实际的信号来做说明。

​		假设我们有一个信号，它含有 2V 的直流分量，频率为 50Hz、相位为 -30 度、幅度为 3V 的交流信号，以及一个频率为 75Hz、相位为 90 度、幅度为 1.5V 的交流信号。用数学表达式就是如下：

$$
S=2+3*cos(2*pi*50*t-pi*30/180)+1.5*cos(2*pi*75*t+pi*90/180)
$$


​		式中 cos 参数为弧度，所以 -30 度和 90 度要分别换算成弧度。我们以 256Hz 的采样率对这个信号进行采样，总共采样 256 点。按照我们上面的分析，Fn=(n-1)*Fs/N，我们可以知道，每两个点之间的间距就是 1Hz，第 n 个点的频率就是 n-1。我们的信号有 3 个频率：0Hz、50Hz、75Hz，应该分别在第 1 个点、第 51 个点、第 76 个点上出现峰值，其它各点应该接近 0。实际情况如何呢？

我们来看看 FFT 的结果的模值如图所示。

 

从图中我们可以看到，在第 1 点、第 51 点、和第 76 点附近有比较大的值。我们分别将这三个点附近的数据拿上来细看：

> 1 点： 512+0i
>
> 2 点： -2.6195E-14 - 1.4162E-13i
>
> 3 点： -2.8586E-14 - 1.1898E-13i
>
> 50 点：-6.2076E-13 - 2.1713E-12i
>
> 51 点：332.55 - 192i
>
> 52 点：-1.6707E-12 - 1.5241E-12i
>
> 75 点：-2.2199E-13 -1.0076E-12i
>
> 76 点：3.4315E-12 + 192i
>
> 77 点：-3.0263E-14 +7.5609E-13i

很明显，1 点、51 点、76 点的值都比较大，它附近的点值都很小，可以认为是 0，即在那些频率点上的信号幅度为 0。接着，我们来计算各点的幅度值。分别计算这三个点的模值，

结果如下：

> 1 点： 512
>
> 51 点：384
>
> 76 点：192

按照公式，可以计算出直流分量为：512/N=512/256=2；50Hz 信号的幅度为：384/(N/2)=384/(256/2)=3；75Hz 信号的幅度为 192/(N/2)=192/(256/2)=1.5。可见，从频谱分析出来的幅度是正确的。

然后再来计算相位信息。直流信号没有相位可言，不用管它。先计算 50Hz 信号的相位，atan2(-192, 332.55)=-0.5236, 结果是弧度，换算为角度就是 180*(-0.5236)/pi=-30.0001。再计算 75Hz 信号的相位，atan2(192, 3.4315E-12)=1.5708 弧度，换算成角度 180*1.5708/pi=90.0002。可见，相位也是对的。

根据 FFT 结果以及上面的分析计算，我们就可以写出信号的表达式了，它就是我们开始提供的信号。

总结：假设采样频率为 Fs，采样点数为 N，做 FFT 之后，某一点 n（n 从 1 开始）表示的频率为：Fn=(n-1)*Fs/N；该点的模值除以 N/2 就是对应该频率下的信号的幅度（对于直流信号是除以 N）；该点的相位即是对应该频率下的信号的相位。相位的计算可用函数 atan2(b,a) 计算。atan2(b,a) 是求坐标为 (a,b) 点的角度值，范围从 -pi 到 pi。要精确到 xHz，则需要采样长度为 1/x 秒的信号，并做 FFT。要提高频率分辨率，就需要增加采样点数，这在一些实际的应用中是不现实的，需要在较短的时间内完成分析。解决这个问题的方法有频率细分法，比较简单的方法是采样比较短时间的信号，然后在后面补充一定数量的 0，使其长度达到需要的点数，再做 FFT，这在一定程度上能够提高频率分辨力。

具体的频率细分法可参考相关文献。

 

---------------------------------------------------------------------------------------------------------------

在 FFT 分析之前应消除直流分量，不然在低频处的谱值，不能确定是信号中的低频成分，还是直流分量的泄漏。

直流量 FFT 后会产生一个 sinc 函数，可能对低频段幅值影响比较大。

---------------------------------------------------------------------------------------------------------------

工程应用上一般都是去掉了直流分量的，效果会好一点，因为有些场合对幅值要求比较高。本来 FFT 就是有误差的（加了窗的），只有去减小误差吧。

---



设置两个频率的信号，分别为100Hz和250Hz，采样率为1024Hz，初始化1024个点，做1024点的快速傅里叶变换。

```matlab
fs=1024;
f1=100;
f2=250;

t=0:1:1024-1;
t=t./fs;

x=2*sin(2*pi*f1*t+pi/4)+1.5*sin(2*pi*f2*t+pi/2);

y=fft(x,1024)';

amp=abs(y);
theta=angle(y);
```

结果如下：

```
1：   -7.81263942428723e-13 + 0.00000000000000i
2：   1.60944088412527e-13 - 5.89450686537649e-13i
3：   -5.15949352125743e-13 - 6.89938093117211e-16i
...
100：   -4.89655738609038e-12 + 1.25685094688277e-11i
101：   724.077343935030 + 724.077343935022i
102：   -9.12837630869656e-12 + 5.07435052715660e-12i
...
250：   -3.15812865852596e-11 + 1.62585102054985e-11i
251：   768.000000000000 + 6.65575372593708e-11i
252：   3.21894704109560e-11 + 1.58212772205164e-11i
```

注意，matlab的输出结果是从1开始的，不是从0.

所以，某点n所表示的频率为：

$$
Fn=(n-1)*Fs/N ，(n=1...N)
$$

$$
Fs=采样率
$$

$$
N=采样点数
$$

第一个点为基频（直流分量）的信号强度。

100Hz信号和250Hz信号的幅度：

$$
\sqrt{724^2+724^2}=1024 
$$

$$
1024/(N/2)=1024/(1024/2)=2
$$

$$
\sqrt{768^2+0^2}=768 
$$

$$
768/(N/2)=768/(1024/2)=1.5
$$

通过计算可知，结果和设计的值相同。

100Hz信号和250Hz信号的相位：
$$
atan(724,724)=0.7854=pi/4 
$$

$$
atan(768,0)=1.5708=pi/2
$$

同样，结果和设计的值相同。

---

N点信号做N点的复数FFT：

>   输入：N点的信号放入实部，虚部为0
>
>   输出：第1点为0Hz（直流分量）的信号强度。（这里为1...N）
>
>   第（N/2+1）点为FS/2的信号强度。
>
>   第2...N/2点为，间隔为FS/N，从FS/N~FS/2-FS/N的频率。
>
>   后面的点与前面的点关于N/2+1这个点做奇对称，幅值相同相位相反。

N点信号做N点的实数FFT：

>   输入：N点的信号放入实数队列。
>
>   输出：第1个点为0Hz的信号强度，无虚部（为0，舍去）
>
>   第2个点为FS/2的信号强度，无虚部（为0，舍去）
>
>   第3，4点为FS/N/2频率的信号强度，先实部后虚部
>
>   ...
>
>   第N-1,N点为频率FS/2-FS/N频率的信号强度。



参考：

```
https://blog.51cto.com/vtkvc/314665
https://blog.csdn.net/shenziheng1/article/details/52891807
https://blog.csdn.net/wordwarwordwar/article/details/68951605
```

