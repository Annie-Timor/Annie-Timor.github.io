---
title: 快速傅里叶变化结果分析
author: lixinghui
date: 2023-7-10 14:10:00 +0800
categories: [DSP, FFT]
tags: [数字信号处理]
math: true
render_with_liquid: false
---

设置两个频率的信号，分别为100Hz和250Hz，采样率为1024Hz，初始化1024个点，做1024点的快速傅里叶变换。

```matlab
fs=1024;
f1=100;
f2=250;

t=0:1:1024-1;
t=t./fs;

x=2*sin(2*pi*f1*t+pi/4)+1.5*sin(2*pi*f2*t+pi/2);

y=fft(x,1024)';

amp=abs(y);
theta=angle(y);
```

结果如下：

```
1：   -7.81263942428723e-13 + 0.00000000000000i
2：   1.60944088412527e-13 - 5.89450686537649e-13i
3：   -5.15949352125743e-13 - 6.89938093117211e-16i
...
100：   -4.89655738609038e-12 + 1.25685094688277e-11i
101：   724.077343935030 + 724.077343935022i
102：   -9.12837630869656e-12 + 5.07435052715660e-12i
...
250：   -3.15812865852596e-11 + 1.62585102054985e-11i
251：   768.000000000000 + 6.65575372593708e-11i
252：   3.21894704109560e-11 + 1.58212772205164e-11i
```

注意，matlab的输出结果是从1开始的，不是从0.

所以，某点n所表示的频率为：

$$
Fn=(n-1)*Fs/N ，(n=1...N)
$$

$$
Fs=采样率
$$

$$
N=采样点数
$$

第一个点为基频（直流分量）的信号强度。

100Hz信号和250Hz信号的幅度：

$$
\sqrt{724^2+724^2}=1024 
$$

$$
1024/(N/2)=1024/(1024/2)=2
$$

$$
\sqrt{768^2+0^2}=768 
$$

$$
768/(N/2)=768/(1024/2)=1.5
$$

通过计算可知，结果和设计的值相同。

100Hz信号和250Hz信号的相位：
$$
atan(724,724)=0.7854=pi/4 
$$

$$
atan(768,0)=1.5708=pi/2
$$

同样，结果和设计的值相同。

---

N点信号做N点的复数FFT：

>   输入：N点的信号放入实部，虚部为0
>
>   输出：第1点为0Hz（直流分量）的信号强度。（这里为1...N）
>
>   第（N/2+1）点为FS/2的信号强度。
>
>   第2...N/2点为，间隔为FS/N，从FS/N~FS/2-FS/N的频率。
>
>   后面的点与前面的点关于N/2+1这个点做奇对称，幅值相同相位相反。

N点信号做N点的实数FFT：

>   输入：N点的信号放入实数队列。
>
>   输出：第1个点为0Hz的信号强度，无虚部（为0，舍去）
>
>   第2个点为FS/2的信号强度，无虚部（为0，舍去）
>
>   第3，4点为FS/N/2频率的信号强度，先实部后虚部
>
>   ...
>
>   第N-1,N点为频率FS/2-FS/N频率的信号强度。



参考：

```
https://blog.51cto.com/vtkvc/314665
https://blog.csdn.net/shenziheng1/article/details/52891807
```

